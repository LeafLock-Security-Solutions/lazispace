#!/bin/bash

echo "Running pre-commit checks..."

# Format code
make fmt > /dev/null 2>&1 || {
    echo "Error: Code formatting failed"
    exit 1
}

# Run linter only if Go files exist
if find . -name "*.go" -not -path "./vendor/*" | grep -q .; then
    make lint || {
        echo "Error: Linting failed"
        echo "Fix the issues or use 'git commit --no-verify' to skip"
        exit 1
    }
else
    echo "No Go files found, skipping linter"
fi

echo "Pre-commit checks passed"
exit 0
